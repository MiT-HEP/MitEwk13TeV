#define rochcor2015_cxx
#include "rochcor2015r.h"
#include "TLorentzVector.h"


const double rochcor2015::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					 0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2015::anetabin[13] = {0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

//---------------------------------------------------------------------------------------------
const double rochcor2015::dcor_bf[16][24]={{-0.000249624,0.000024804,-0.000138692,-0.000029883,-0.000059439,-0.000052882,-0.000030064,-0.000068376,-0.000033411,0.000027774,0.000018271,-0.000072023,-0.000006598,-0.000037348,0.000002572,-0.000023172,-0.000024522,-0.000072178,-0.000032500,-0.000071134,0.000005970,-0.000099086,-0.000117899,-0.000130200},
{-0.000243658,0.000000772,-0.000091271,-0.000016309,-0.000047223,-0.000008257,-0.000008321,-0.000018318,0.000067173,0.000011583,0.000057961,0.000000089,0.000054616,0.000007194,0.000015703,0.000043841,0.000018792,0.000007979,-0.000103594,-0.000024731,-0.000097888,-0.000172177,-0.000154439,-0.000125639},
{0.000022092,0.000022188,-0.000140885,-0.000076332,-0.000059618,-0.000036391,-0.000022908,0.000024923,-0.000043411,0.000013751,-0.000021679,0.000000845,-0.000012732,0.000020400,0.000034685,-0.000056326,-0.000070524,-0.000032137,-0.000051955,-0.000073379,-0.000049807,0.000033369,-0.000012889,-0.000211764},
{0.000018516,-0.000016266,-0.000021382,-0.000116206,-0.000060182,-0.000056071,-0.000033588,-0.000059911,-0.000048514,-0.000028877,0.000032362,-0.000018785,0.000028452,-0.000020181,0.000048335,0.000020833,-0.000076166,-0.000075320,-0.000071864,-0.000139382,-0.000045669,-0.000145737,-0.000186279,-0.000118883},
{-0.000138451,-0.000181828,-0.000067218,-0.000097994,-0.000083415,-0.000086555,-0.000070023,-0.000102986,0.000010722,-0.000067976,-0.000019555,-0.000009779,0.000058147,-0.000003990,0.000031867,-0.000038868,-0.000024740,-0.000018321,-0.000047766,-0.000015336,-0.000038632,-0.000136531,0.000008549,-0.000187260},
{-0.000110840,-0.000102924,-0.000058166,-0.000030533,-0.000065872,-0.000058876,-0.000042870,-0.000025473,0.000045377,-0.000027969,-0.000018136,-0.000021154,0.000002984,-0.000052440,-0.000063057,0.000042822,0.000025626,0.000005122,-0.000011734,-0.000096233,-0.000037720,0.000002836,0.000046560,-0.000130417},
{-0.000073451,-0.000024098,-0.000074600,-0.000067498,-0.000074587,-0.000054837,-0.000043141,-0.000029930,-0.000039381,0.000009178,-0.000031017,-0.000077128,-0.000060335,-0.000071189,-0.000064991,-0.000029450,-0.000002097,-0.000074453,-0.000106682,-0.000098852,-0.000167549,-0.000155050,-0.000019185,-0.000058440},
{-0.000167221,-0.000230773,-0.000120587,-0.000003043,-0.000084897,-0.000024705,-0.000007420,0.000138908,-0.000000507,0.000023872,-0.000027654,0.000030197,0.000005210,-0.000074769,-0.000095185,-0.000016453,-0.000004532,0.000014168,-0.000066172,-0.000153208,-0.000143303,-0.000011318,-0.000062993,-0.000069947},
{-0.000078033,-0.000150009,-0.000090980,-0.000056584,-0.000049079,0.000011886,-0.000023394,-0.000065291,-0.000107006,-0.000017640,0.000025049,-0.000022119,-0.000069234,-0.000082734,-0.000055710,-0.000026254,0.000031449,0.000012932,-0.000004363,-0.000104480,-0.000108926,-0.000028645,-0.000121158,0.000004746},
{-0.000160329,-0.000135171,-0.000096250,-0.000081476,-0.000114445,0.000015023,0.000008212,-0.000040726,-0.000008875,0.000031282,-0.000016411,0.000003011,0.000039849,0.000008878,-0.000047779,0.000061950,-0.000047870,-0.000003919,-0.000069220,-0.000040710,0.000016126,-0.000122851,-0.000195028,-0.000148191},
{-0.000017224,-0.000055628,-0.000061728,-0.000046090,-0.000070030,-0.000020879,-0.000007499,-0.000024998,-0.000076598,-0.000041409,-0.000021153,0.000010872,0.000042027,-0.000009004,-0.000011659,0.000026885,-0.000041122,-0.000137325,-0.000088889,-0.000041306,-0.000102381,-0.000131022,-0.000135619,-0.000074291},
{-0.000051128,-0.000114373,-0.000112148,-0.000128609,0.000045247,-0.000064248,0.000042793,0.000004578,0.000038971,-0.000016875,0.000003580,-0.000009246,0.000038932,-0.000002304,-0.000021726,-0.000037627,0.000005628,-0.000005132,-0.000016737,-0.000007910,-0.000077623,-0.000170624,-0.000118542,-0.000291040},
{-0.000193187,-0.000165678,-0.000095377,-0.000050945,-0.000093916,-0.000074330,0.000021636,-0.000023109,-0.000033594,-0.000008158,-0.000015533,-0.000022391,0.000027073,-0.000062515,-0.000041658,-0.000027919,-0.000061319,-0.000068176,-0.000078066,-0.000150373,-0.000076610,-0.000135389,-0.000145521,-0.000151596},
{-0.000147050,-0.000095566,-0.000044202,-0.000104657,-0.000041692,-0.000077494,-0.000076177,0.000067196,0.000008718,-0.000024163,-0.000001203,-0.000006095,-0.000037533,0.000021356,-0.000015767,-0.000047894,0.000022526,-0.000031322,-0.000134806,-0.000166292,-0.000061919,-0.000114415,-0.000059782,-0.000101394},
{-0.000043815,-0.000102653,-0.000130923,-0.000068475,-0.000097771,-0.000060202,-0.000032980,-0.000019432,-0.000033536,0.000007157,-0.000001260,0.000060800,-0.000039504,-0.000002257,0.000128218,0.000004086,-0.000039221,-0.000026111,-0.000009269,-0.000119573,-0.000088064,-0.000176052,-0.000087213,-0.000114382},
{-0.000107982,-0.000170969,-0.000211362,-0.000058592,-0.000140223,-0.000067411,-0.000027102,-0.000004335,0.000013462,-0.000123544,-0.000015871,0.000018268,-0.000014804,-0.000059022,0.000023323,0.000001263,-0.000034906,-0.000009625,-0.000004049,-0.000100730,-0.000138624,-0.000136207,-0.000009665,-0.000158097}};
const double rochcor2015::dcor_ma[16][24]={{0.000886983,0.000578336,0.000269531,0.000188939,0.000142953,0.000124527,0.000047689,0.000059829,0.000060935,0.000052222,0.000040188,0.000104074,0.000063987,0.000010336,0.000061041,0.000038857,0.000002079,0.000058864,0.000039704,0.000091281,0.000037857,0.000199656,0.000264249,0.000306817},
{0.000868304,0.000664589,0.000319553,0.000156717,0.000101035,0.000058732,0.000025746,0.000050180,0.000074156,0.000042422,-0.000002422,-0.000002473,0.000042792,0.000035607,0.000024518,0.000056910,0.000019029,0.000085243,0.000111227,0.000156662,0.000125980,0.000243751,0.000232306,0.000322392},
{0.000831528,0.000445941,0.000257714,0.000162699,0.000120695,0.000076318,-0.000019978,0.000070290,0.000029195,0.000086205,0.000024237,0.000078181,0.000005978,0.000037562,0.000047455,0.000008564,0.000024359,0.000046856,0.000089548,0.000120137,0.000190542,0.000238502,0.000300141,0.000470024},
{0.000473252,0.000273542,-0.000003982,0.000000715,0.000054738,-0.000026621,0.000028577,-0.000001503,0.000012354,0.000058099,0.000026481,0.000019255,0.000000304,0.000000887,0.000012749,-0.000004231,0.000029524,0.000072868,0.000089308,0.000150954,0.000043286,0.000189217,0.000199248,0.000269985},
{-0.000092682,0.000003321,-0.000050448,0.000010498,0.000003827,-0.000068089,0.000020105,0.000013151,0.000024971,-0.000007620,-0.000004402,-0.000046120,-0.000042238,-0.000016474,-0.000006839,0.000005408,0.000051620,0.000030633,-0.000019343,-0.000019874,0.000074148,0.000058215,0.000151376,0.000214267},
{-0.000388549,-0.000204001,-0.000164333,-0.000063661,-0.000158370,-0.000074359,0.000040825,0.000001430,0.000067425,0.000002182,0.000017332,-0.000018199,-0.000018204,-0.000003322,-0.000004839,-0.000031271,-0.000049397,-0.000042794,-0.000008859,-0.000164113,-0.000075926,-0.000011805,0.000095301,-0.000038161},
{-0.000843720,-0.000395453,-0.000270481,-0.000141063,-0.000118331,0.000007082,-0.000022900,-0.000005340,-0.000031620,-0.000023743,-0.000001626,-0.000012192,0.000011885,-0.000024130,-0.000118588,-0.000027853,-0.000015881,-0.000008014,-0.000017646,-0.000103588,-0.000056857,-0.000089775,0.000053408,-0.000027161},
{-0.000754236,-0.000460710,-0.000272567,-0.000166170,-0.000097685,-0.000036936,-0.000024473,0.000009150,-0.000004340,-0.000023411,-0.000012949,-0.000006185,0.000006510,-0.000038947,0.000026048,0.000036160,0.000012501,0.000051481,-0.000058371,-0.000050503,-0.000078079,-0.000121652,-0.000026301,-0.000028606},
{-0.000809329,-0.000445416,-0.000339777,-0.000106129,-0.000064101,0.000036421,0.000031516,0.000016960,0.000003757,-0.000002209,0.000003172,0.000029280,0.000032187,0.000034579,0.000037626,0.000004443,0.000007468,0.000007734,-0.000017614,-0.000000649,-0.000070330,-0.000047467,-0.000055756,0.000134463},
{-0.000741353,-0.000533453,-0.000199204,-0.000149269,-0.000029189,-0.000055309,0.000031502,0.000006477,-0.000045345,-0.000059699,-0.000007280,-0.000007436,0.000014112,0.000015824,0.000030075,0.000014831,0.000081597,0.000040883,0.000056079,-0.000011959,-0.000011436,-0.000065004,0.000120309,0.000108332},
{-0.000553422,-0.000450994,-0.000167367,-0.000061418,-0.000112668,-0.000036214,-0.000025164,0.000014715,-0.000031946,0.000017106,0.000014280,0.000063008,-0.000015352,-0.000015556,0.000048493,-0.000026704,-0.000085651,-0.000006890,-0.000058034,-0.000043408,0.000028041,-0.000070800,-0.000098450,-0.000035207},
{-0.000308729,-0.000261234,-0.000133931,-0.000070529,-0.000011514,0.000046316,0.000011371,-0.000060373,-0.000052385,-0.000007473,0.000003022,0.000011266,-0.000033044,0.000035241,0.000019532,0.000019404,0.000025262,-0.000045642,-0.000014216,0.000007641,-0.000058013,-0.000103296,-0.000151625,-0.000118439},
{0.000094333,0.000033428,-0.000001747,0.000033129,-0.000038277,-0.000000406,0.000046856,-0.000054293,-0.000034621,-0.000001111,0.000015655,-0.000003754,-0.000026848,-0.000026532,0.000023114,-0.000017562,0.000019900,-0.000002849,-0.000017070,-0.000003967,-0.000056035,-0.000143406,-0.000118187,-0.000086928},
{0.000247201,0.000144426,0.000144497,0.000042208,0.000012913,0.000030303,0.000012865,0.000077802,-0.000014125,-0.000037160,0.000033340,0.000066095,0.000007673,-0.000008682,0.000023223,0.000014654,-0.000062581,-0.000000419,-0.000066172,-0.000048451,-0.000103010,-0.000133080,-0.000154913,-0.000055652},
{0.000562222,0.000370943,0.000203576,0.000132354,0.000043588,0.000085560,0.000023940,0.000015506,0.000007599,0.000008488,0.000007805,0.000007854,0.000054984,-0.000026023,0.000033234,-0.000025716,-0.000046091,-0.000015873,-0.000062871,-0.000108063,-0.000024039,-0.000085973,-0.000046117,-0.000088304},
{0.000670597,0.000446541,0.000392396,0.000116858,0.000131547,0.000102586,0.000043316,0.000048308,0.000012318,0.000038126,0.000044689,-0.000071110,0.000039377,0.000023028,-0.000001032,0.000001573,0.000080441,0.000014552,-0.000017286,-0.000043087,-0.000039348,0.000095644,0.000115353,0.000076713}};
const double rochcor2015::mcor_bf[16][24]={{-0.000175727,-0.000063154,-0.000025927,-0.000011165,-0.000012717,0.000023160,0.000037431,0.000036756,0.000063633,0.000035071,0.000059056,0.000061784,0.000057653,0.000075366,0.000070137,0.000067908,-0.000000423,0.000048430,0.000022848,0.000028214,0.000000445,0.000000303,-0.000094081,-0.000176214},
{-0.000110913,-0.000052014,-0.000007922,-0.000011585,-0.000033643,0.000040894,0.000059994,0.000028955,0.000070481,0.000078608,0.000072872,0.000086489,0.000033579,0.000041069,0.000078060,0.000064447,0.000055939,0.000078907,0.000031057,0.000031763,0.000022766,-0.000002839,-0.000020134,-0.000189756},
{0.000011721,-0.000002169,-0.000038334,-0.000018645,0.000046695,0.000009651,0.000009436,0.000034141,0.000021275,0.000075233,0.000021200,0.000048819,0.000029329,0.000062449,0.000043526,0.000073370,0.000026828,0.000032523,0.000035361,0.000057557,-0.000026937,0.000003661,-0.000073113,-0.000153735},
{0.000020420,-0.000061347,0.000012619,0.000005049,-0.000001189,0.000017682,0.000021210,0.000048715,0.000016510,0.000002179,0.000059356,0.000037057,0.000055633,0.000041931,0.000047533,0.000053305,-0.000005747,0.000043119,0.000030945,-0.000008105,-0.000027039,-0.000019331,-0.000051573,-0.000107739},
{-0.000071031,-0.000029773,0.000000941,-0.000037073,-0.000000476,0.000001463,-0.000005923,0.000041316,0.000037135,0.000023587,0.000063954,0.000054629,0.000041288,0.000046729,0.000058521,0.000035427,0.000008715,0.000021413,0.000029269,-0.000018501,-0.000023605,-0.000013005,-0.000016213,-0.000071937},
{-0.000065635,-0.000044744,0.000006985,-0.000028821,0.000012974,0.000017689,0.000053252,0.000045431,0.000043676,0.000057371,0.000055732,0.000050153,0.000065684,0.000007064,0.000038681,0.000034162,0.000044568,0.000084096,0.000026917,0.000004934,0.000023191,0.000002077,-0.000022143,-0.000118656},
{-0.000104428,0.000036674,-0.000022838,-0.000024250,-0.000009127,0.000013820,0.000046199,0.000035521,0.000060865,0.000057700,0.000049943,0.000037379,0.000050477,0.000023774,0.000034603,0.000051661,0.000033240,0.000031359,0.000033223,-0.000011628,-0.000002863,-0.000021477,-0.000057232,-0.000143990},
{-0.000068466,-0.000005848,-0.000018980,0.000013450,-0.000003775,0.000052665,0.000027199,0.000069554,0.000038209,0.000046438,0.000047727,0.000066596,0.000063131,0.000042783,0.000037062,0.000028115,0.000069120,0.000044197,-0.000009358,-0.000018956,0.000005219,-0.000005295,0.000005839,-0.000085738},
{-0.000078739,-0.000058204,-0.000026762,0.000035992,0.000004022,0.000016037,0.000058429,0.000046274,0.000046652,0.000051590,0.000048720,0.000044312,0.000065776,0.000054701,0.000039805,0.000060175,0.000046073,0.000053404,0.000043466,-0.000045767,-0.000011718,-0.000023017,0.000004411,-0.000051375},
{-0.000125202,-0.000019905,-0.000033109,0.000018388,-0.000018219,0.000005548,0.000054619,0.000019952,0.000076506,0.000046447,0.000037810,0.000015483,0.000048151,0.000050251,0.000055714,0.000053800,0.000039515,0.000029780,-0.000010115,-0.000000907,0.000035280,0.000034491,-0.000074346,-0.000098902},
{-0.000132128,-0.000090727,-0.000012277,-0.000019167,0.000004852,0.000047528,0.000049916,0.000060545,0.000030825,0.000060946,0.000046550,0.000085567,0.000066020,0.000066540,0.000048560,0.000074605,0.000026164,0.000034948,-0.000015556,-0.000009535,-0.000017877,0.000004341,-0.000029902,-0.000150009},
{-0.000096590,-0.000055786,-0.000012916,0.000017526,0.000047431,0.000052792,0.000075795,0.000072459,0.000059344,0.000052769,0.000048015,0.000070075,0.000058106,0.000078008,0.000074767,0.000039397,0.000063598,0.000076861,0.000028660,0.000022974,0.000017742,-0.000026545,0.000028797,-0.000071640},
{-0.000150925,-0.000061149,0.000009530,-0.000029954,0.000021001,0.000042961,0.000065415,0.000048631,0.000049006,0.000065558,0.000023995,0.000073076,0.000033465,0.000037628,0.000066075,0.000072214,0.000060937,0.000033334,0.000015590,-0.000000614,0.000007074,-0.000042700,0.000012891,-0.000084402},
{-0.000074487,-0.000015972,-0.000002086,0.000020375,0.000024956,0.000029245,0.000052118,0.000050567,0.000071036,0.000049143,0.000019967,0.000064606,0.000041762,0.000058115,0.000066015,0.000035085,0.000034063,0.000041182,0.000008472,0.000019746,0.000007978,0.000020454,-0.000010724,0.000064572},
{-0.000114722,-0.000049599,0.000003268,0.000034657,-0.000003238,-0.000001820,0.000016633,0.000053419,0.000064480,0.000057275,0.000046349,0.000073424,0.000089327,0.000062366,0.000072627,0.000047421,0.000045932,0.000041012,0.000049684,0.000040073,0.000025192,-0.000038146,-0.000015303,-0.000123805},
{-0.000098238,-0.000078778,-0.000037632,0.000038589,-0.000006340,-0.000005162,-0.000025543,0.000036213,0.000038388,0.000013730,0.000028649,0.000050183,0.000036253,0.000067004,0.000063562,0.000005701,0.000051478,0.000045505,0.000004035,-0.000003578,0.000022058,-0.000014110,-0.000007544,-0.000006558}};
const double rochcor2015::mcor_ma[16][24]={{0.000036846,0.000029432,-0.000026063,-0.000025846,0.000020060,0.000011267,-0.000022181,0.000017265,-0.000019336,-0.000006401,-0.000030408,-0.000010478,-0.000004045,-0.000005397,-0.000010366,-0.000016993,-0.000013796,-0.000004859,0.000024199,0.000032366,-0.000016945,-0.000004236,-0.000023197,0.000036139},
{-0.000056986,0.000015309,-0.000020477,-0.000005567,0.000008979,-0.000008746,-0.000037196,-0.000039512,-0.000017194,-0.000013831,-0.000005554,0.000003590,-0.000028467,0.000010754,-0.000029226,0.000007319,-0.000031567,0.000003522,0.000013483,0.000013182,0.000006725,0.000071875,0.000011548,0.000034696},
{0.000030927,0.000019774,0.000098256,0.000015813,-0.000007876,-0.000024953,-0.000030258,-0.000019580,-0.000013196,-0.000008189,0.000001155,-0.000000564,-0.000020149,-0.000006337,-0.000018852,-0.000011041,-0.000025068,-0.000018798,-0.000000967,0.000020413,0.000036980,0.000045468,0.000068991,0.000096827},
{-0.000011103,-0.000047488,-0.000038835,-0.000026219,-0.000063094,-0.000057749,-0.000011878,-0.000038610,-0.000016812,-0.000012521,0.000014342,-0.000002065,-0.000020286,-0.000025766,0.000014516,-0.000014180,0.000004023,-0.000031139,0.000019946,0.000024170,0.000001366,0.000037422,0.000043789,0.000122395},
{-0.000066542,-0.000032899,-0.000027745,0.000006708,-0.000026478,-0.000018004,-0.000029313,0.000022954,0.000001740,0.000002883,-0.000004573,0.000000419,0.000035533,-0.000001620,-0.000019273,-0.000004134,-0.000012912,0.000029668,0.000020518,0.000009228,0.000009400,-0.000035577,0.000077511,-0.000028864},
{-0.000000828,0.000056753,0.000002953,-0.000008803,-0.000002399,0.000014629,0.000013962,0.000002148,0.000007089,0.000021194,-0.000007866,0.000017372,0.000014957,0.000013953,0.000051559,-0.000003051,-0.000006584,0.000037723,0.000036034,0.000027710,0.000006693,-0.000026441,-0.000034703,-0.000050385},
{0.000009520,0.000091749,-0.000013336,0.000022545,0.000014505,-0.000021588,-0.000002646,0.000021934,0.000020166,0.000040055,0.000026684,0.000015908,0.000007234,0.000024786,0.000024599,0.000011288,0.000053283,0.000022383,0.000009746,0.000007531,0.000038500,0.000024702,0.000004725,-0.000024942},
{0.000069224,0.000064138,0.000067186,0.000043257,0.000014016,0.000040464,0.000048331,-0.000010224,0.000037189,0.000002838,0.000018758,0.000033266,0.000013347,0.000001122,0.000040155,0.000056021,0.000061709,0.000044177,-0.000021970,0.000011749,0.000005474,0.000016407,-0.000031919,-0.000032901},
{0.000121563,0.000087808,0.000050304,0.000033738,0.000015692,0.000056504,0.000002657,0.000047608,0.000016217,0.000039515,0.000024680,0.000021875,0.000021968,0.000016156,0.000046499,-0.000015713,0.000008209,0.000050725,0.000028040,0.000040261,0.000028729,0.000080774,0.000116283,0.000025289},
{0.000065797,0.000046152,0.000039288,0.000043069,0.000025331,0.000024823,-0.000018466,0.000031444,-0.000011117,0.000019897,0.000021323,0.000005839,0.000004425,0.000042414,0.000030271,0.000038895,0.000029167,0.000029964,0.000044898,0.000073045,0.000075686,0.000040022,0.000089036,0.000234725},
{0.000005152,-0.000028908,-0.000050723,-0.000007763,-0.000040424,-0.000039827,0.000009324,-0.000019752,-0.000003058,0.000007067,0.000034309,0.000014032,0.000026771,0.000001476,0.000013067,-0.000002220,0.000005977,0.000015778,-0.000001706,0.000008903,0.000070781,0.000072669,0.000041182,0.000055971},
{-0.000087416,-0.000025984,-0.000023199,0.000000176,-0.000005068,0.000028669,-0.000038456,0.000002207,-0.000024864,0.000009701,-0.000009238,0.000015902,0.000030377,0.000002567,0.000035704,0.000009961,0.000042209,0.000020774,0.000040466,0.000022482,0.000042946,0.000022526,0.000042704,0.000029452},
{-0.000057650,0.000013460,-0.000005913,-0.000005964,-0.000010268,-0.000023159,0.000002015,-0.000019173,-0.000013673,-0.000013000,-0.000027522,-0.000004100,0.000022991,0.000027789,0.000008455,0.000002263,0.000014608,0.000026216,0.000006107,0.000009838,0.000012780,0.000006203,0.000033740,0.000069481},
{-0.000012022,-0.000004659,0.000004538,-0.000032419,0.000005437,-0.000035147,-0.000032805,-0.000016249,-0.000046226,-0.000001748,0.000000929,-0.000001691,-0.000021361,-0.000003537,0.000001745,-0.000009244,-0.000004613,-0.000004963,-0.000010181,0.000000322,-0.000034374,-0.000027550,-0.000059456,0.000007926},
{-0.000006109,-0.000051557,-0.000002188,-0.000043533,-0.000035561,-0.000037214,-0.000029792,-0.000019256,-0.000029802,-0.000017865,-0.000020305,-0.000047455,0.000002627,-0.000010728,-0.000001997,-0.000027084,-0.000005533,-0.000037189,-0.000024477,-0.000021306,-0.000018384,-0.000060918,-0.000074370,-0.000051935},
{-0.000002891,0.000051660,0.000003999,0.000015668,0.000002679,-0.000023900,-0.000014593,-0.000018315,-0.000017515,0.000004761,-0.000012238,-0.000028699,-0.000038199,-0.000028179,-0.000029691,-0.000016842,-0.000024722,-0.000014782,-0.000034922,-0.000064055,-0.000029825,-0.000002237,-0.000055602,-0.000148586}};
//==========================================================================================================================
const double rochcor2015::dmavg[16][24]={{0.025763154,0.025298391,0.025269399,0.024777260,0.024708183,0.024677735,0.024671865,0.024880004,0.024928021,0.025144852,0.025084954,0.025502786,0.025408001,0.025106871,0.024968131,0.024875399,0.024716328,0.024668664,0.024884718,0.024669787,0.024732597,0.025141331,0.025273740,0.025615128},
{0.025721548,0.025335077,0.025156620,0.024869032,0.024635208,0.024522434,0.024710685,0.024556364,0.024875670,0.025042745,0.025102117,0.025249682,0.025177940,0.025134052,0.025199341,0.024831449,0.024910800,0.024584840,0.024563525,0.024776538,0.024680957,0.025265710,0.025489573,0.025410233},
{0.025562288,0.025236603,0.025074782,0.024741157,0.024490126,0.024808041,0.024641264,0.024846666,0.024887500,0.025067757,0.025153089,0.025279244,0.025395179,0.025426468,0.025225218,0.024922144,0.024734565,0.024756864,0.024698860,0.024830829,0.024826432,0.024835231,0.025197775,0.025660128},
{0.025440774,0.025209744,0.024992419,0.024831373,0.024717214,0.024564085,0.024561702,0.024807838,0.024920942,0.024953114,0.025093234,0.025350446,0.025589954,0.025244176,0.024978350,0.024938698,0.024707098,0.024794438,0.024556112,0.024717327,0.024739597,0.025058579,0.025260541,0.025562036},
{0.025482305,0.025487335,0.024809814,0.024773772,0.024660859,0.024650396,0.024833234,0.024873052,0.024873701,0.025294420,0.025130857,0.025408482,0.025341459,0.025260837,0.025114813,0.025115857,0.024870841,0.024662609,0.024839639,0.024682330,0.024800658,0.024980796,0.025205051,0.025670395},
{0.025514204,0.025303409,0.025020593,0.024895062,0.024559461,0.024666983,0.024625669,0.024895649,0.024929285,0.025041778,0.025322073,0.025369913,0.025387031,0.025365906,0.025093924,0.024968420,0.024724006,0.024689278,0.024627706,0.024617881,0.024688806,0.025177062,0.025468794,0.025650235},
{0.025552912,0.025275383,0.024957884,0.024880589,0.024686031,0.024632854,0.024639261,0.024736123,0.024957167,0.025025621,0.025197432,0.025502749,0.025223948,0.025315417,0.025014133,0.024897756,0.024628884,0.024881048,0.024784225,0.024652422,0.024881584,0.025134307,0.025406423,0.025397582},
{0.025591924,0.025497035,0.025181561,0.024929514,0.024648736,0.024799611,0.024510861,0.024835062,0.024749131,0.025055765,0.025262433,0.025265169,0.025330661,0.025286558,0.025208091,0.024876815,0.024760044,0.024534509,0.024498629,0.024633197,0.024853170,0.025108923,0.025430702,0.025492636},
{0.025514888,0.025281488,0.024935933,0.025000353,0.024707944,0.024634061,0.024632608,0.024840178,0.024979687,0.025040035,0.025131622,0.025400564,0.025395655,0.025331688,0.025121252,0.024782984,0.024720248,0.024669828,0.024537873,0.024743835,0.024774015,0.025000730,0.025080512,0.025776832},
{0.025642865,0.024923380,0.025067361,0.024757324,0.024673461,0.024611905,0.024551928,0.024834355,0.025079735,0.025015119,0.025008390,0.025294977,0.025283209,0.025187266,0.024996571,0.024799156,0.024656528,0.024797132,0.024677675,0.024528603,0.024744507,0.025125772,0.025188254,0.025652602},
{0.025486170,0.025180773,0.025286997,0.024856682,0.024623117,0.024836503,0.024696306,0.024910886,0.024823777,0.025171175,0.025230369,0.025362371,0.025187628,0.025084897,0.025128367,0.024799079,0.024580695,0.024772789,0.024566496,0.024481502,0.024810516,0.025020208,0.025462849,0.025464548},
{0.025404394,0.025046409,0.025120302,0.024874038,0.024695442,0.024642957,0.024679663,0.024760077,0.024958614,0.025146653,0.025275407,0.025465274,0.025145069,0.025222643,0.025127314,0.024974182,0.024785013,0.024697213,0.024634003,0.024699372,0.024840371,0.025074146,0.025469420,0.025581096},
{0.025648304,0.025251140,0.025041949,0.024827590,0.024714269,0.024697231,0.024798103,0.024852095,0.025051785,0.025144887,0.025229820,0.025342797,0.025171185,0.025374141,0.025031642,0.024871206,0.024733795,0.024589426,0.024676084,0.024859220,0.024876727,0.025104685,0.025391754,0.025652601},
{0.025635302,0.025383028,0.025036616,0.024937725,0.024642517,0.024844584,0.024697471,0.024681794,0.024901440,0.024956168,0.025275303,0.025296787,0.025405741,0.025191088,0.025074201,0.024806541,0.024710269,0.024688769,0.024744870,0.024836992,0.024803549,0.025191519,0.025504861,0.025383840},
{0.025762278,0.025345132,0.025104936,0.024883663,0.024725418,0.024843573,0.024687250,0.024753325,0.025099525,0.024987496,0.025305218,0.025309619,0.025338043,0.025314579,0.024838646,0.024788156,0.024713186,0.024852744,0.024682975,0.024732632,0.024807691,0.025146314,0.025604603,0.025530423},
{0.025651605,0.025350509,0.025124250,0.024808191,0.024825619,0.024769941,0.024650536,0.024686579,0.024925656,0.025044596,0.025202444,0.025337363,0.025206090,0.025346880,0.025017440,0.024827097,0.024892681,0.024769760,0.024376551,0.024755591,0.024757652,0.025285031,0.025297858,0.025636733}};
const double rochcor2015::dpavg[16][24]={{0.025793989,0.025095899,0.025266602,0.024825673,0.024560357,0.024607456,0.024565266,0.024732312,0.025009579,0.025113643,0.025259342,0.025413878,0.025496460,0.025372393,0.024991711,0.024966047,0.024861443,0.024685248,0.024602056,0.024675384,0.024827457,0.025196365,0.025160004,0.025645754},
{0.025849480,0.025135017,0.024965077,0.024756457,0.024596793,0.024675503,0.024814491,0.024812368,0.024893077,0.025137583,0.025186781,0.025441247,0.025298023,0.025345463,0.025147894,0.024932040,0.024755922,0.024721487,0.024729788,0.024731899,0.024767932,0.025150381,0.025487302,0.025537532},
{0.025504020,0.025025608,0.025241661,0.024762119,0.024703945,0.024757446,0.024702647,0.024743252,0.024896557,0.024984142,0.025275883,0.025461057,0.025394997,0.025385466,0.025136857,0.025059118,0.024845991,0.024611864,0.024680552,0.024796990,0.024705894,0.024919497,0.025220442,0.025565745},
{0.025354853,0.025153465,0.025085652,0.024950449,0.024623953,0.024491784,0.024688365,0.024794095,0.024986576,0.025105328,0.025243417,0.025504959,0.025403130,0.025158726,0.025091631,0.024849401,0.024885343,0.024804907,0.024658307,0.024704448,0.024787678,0.025209006,0.025296444,0.025531722},
{0.025529511,0.025290620,0.024967452,0.024694031,0.024834960,0.024765397,0.024630344,0.024914261,0.025061295,0.025276965,0.025370271,0.025419189,0.025377810,0.025266217,0.025063347,0.025042749,0.024877080,0.024525185,0.024752487,0.024523278,0.024813024,0.025208356,0.025198758,0.025587126},
{0.025658790,0.025585474,0.025083707,0.024620466,0.024737280,0.024719557,0.024696008,0.024742970,0.024941460,0.025367333,0.025223914,0.025291720,0.025356006,0.025143130,0.025121182,0.024912450,0.024808540,0.024725419,0.024581548,0.024809450,0.024843518,0.025126473,0.025357642,0.025856868},
{0.025915889,0.025756238,0.025121105,0.024730666,0.024718489,0.024576173,0.024645784,0.024674669,0.025032731,0.025087427,0.025277643,0.025311510,0.025280184,0.025260752,0.025258008,0.024919920,0.024718309,0.024914670,0.024654902,0.024858393,0.025022245,0.025332304,0.025495708,0.025616033},
{0.025852847,0.025698521,0.025042646,0.024998320,0.024706566,0.024657620,0.024633838,0.024758519,0.024958233,0.024794737,0.025236087,0.025418282,0.025341229,0.025311826,0.025127934,0.024876898,0.024871041,0.024690258,0.024608019,0.024946311,0.025105344,0.025182198,0.025379138,0.025962130},
{0.025785534,0.025567578,0.025200029,0.024940342,0.024701452,0.024576444,0.024587893,0.024979250,0.025067104,0.025292613,0.025321957,0.025387825,0.025480064,0.025176299,0.024951277,0.024933758,0.024969989,0.024725411,0.024555764,0.024793982,0.024881448,0.025031569,0.025453809,0.025547420},
{0.025945881,0.025446364,0.025207250,0.025038893,0.024629787,0.024714327,0.024612623,0.024808451,0.024930915,0.025091356,0.025194439,0.025372555,0.025195548,0.025192203,0.025010914,0.024852686,0.024680324,0.024656833,0.024759828,0.024664517,0.024878559,0.025153055,0.025150658,0.025894990},
{0.025581731,0.025568580,0.025123282,0.024889822,0.024870271,0.024645963,0.024803666,0.024807784,0.025058202,0.025112643,0.025225140,0.025298197,0.025360089,0.025338842,0.025041038,0.024977822,0.024837685,0.024720045,0.024650451,0.024934287,0.024826205,0.025126290,0.025519163,0.025736513},
{0.025422197,0.025462896,0.025318717,0.025038950,0.024742300,0.024688833,0.024503608,0.024758243,0.024905058,0.025197672,0.025105620,0.025343191,0.025318390,0.025223225,0.025215184,0.024768648,0.024868966,0.024880516,0.024630823,0.024648714,0.025085209,0.025259387,0.025753165,0.025899188},
{0.025621261,0.025481747,0.025092835,0.024715987,0.024691370,0.024775815,0.024590803,0.024768261,0.025051828,0.025099597,0.025455884,0.025187643,0.025214233,0.025479468,0.025140627,0.024874231,0.024831843,0.024745746,0.024763259,0.024807387,0.024989684,0.025048331,0.025427910,0.025738020},
{0.025558256,0.025210926,0.024984782,0.024854421,0.024841375,0.024669654,0.024835945,0.024672828,0.024939663,0.025075171,0.025148886,0.025294824,0.025459719,0.025090783,0.025130860,0.024917959,0.024737133,0.024800864,0.024682349,0.024852002,0.024720962,0.025045368,0.025481771,0.025624312},
{0.025309936,0.025073226,0.025042843,0.024835325,0.024711648,0.024629797,0.024673771,0.024765237,0.024878441,0.025265274,0.025192706,0.025333662,0.025535455,0.025208616,0.024908378,0.025079689,0.024925600,0.024684290,0.024832361,0.024852694,0.024899935,0.025312538,0.025421614,0.025610726},
{0.025444221,0.025477813,0.025214289,0.024980968,0.024929760,0.024677386,0.024621785,0.024751733,0.024926377,0.025121255,0.025248812,0.025376743,0.025247545,0.025280027,0.025152157,0.024917850,0.024696809,0.024669955,0.024548007,0.024900322,0.025012608,0.025258596,0.025584808,0.025640963}};
const double rochcor2015::mmavg[16][24]={{0.025184775,0.025429038,0.025112689,0.024796303,0.024721306,0.024494649,0.024526873,0.024673819,0.024705793,0.025223469,0.025223540,0.025135162,0.025191123,0.025257849,0.024944171,0.024883560,0.024828056,0.024618500,0.024625730,0.024557545,0.024876033,0.024917007,0.025235354,0.025485004},
{0.025450078,0.025304829,0.025000470,0.024808403,0.024871401,0.024417088,0.024745559,0.024735764,0.024885270,0.025008179,0.025223264,0.025231552,0.025351290,0.025315576,0.025093147,0.024947842,0.024857190,0.024584271,0.024477550,0.024576719,0.024648944,0.024870694,0.025358900,0.025457765},
{0.025361895,0.025427202,0.024862898,0.024714946,0.024438509,0.024545232,0.024830747,0.024825861,0.024845981,0.024900397,0.025216451,0.025257220,0.025487647,0.025316817,0.025172685,0.024791030,0.024745458,0.024675488,0.024591574,0.024515753,0.024675004,0.025185238,0.025316005,0.025252460},
{0.025384483,0.025220750,0.025269833,0.024840707,0.024576213,0.024523994,0.024682410,0.024670653,0.024852290,0.025004520,0.025428136,0.025396698,0.025440403,0.025217585,0.025221897,0.024975955,0.024545977,0.024434549,0.024448594,0.024459897,0.024855014,0.024819817,0.025114713,0.025481194},
{0.025623391,0.025121150,0.024864920,0.024599321,0.024592512,0.024671366,0.024635778,0.024660316,0.024885418,0.024872775,0.025270310,0.025356738,0.025508847,0.025390166,0.025212795,0.024957097,0.024825650,0.024873206,0.024744631,0.024538940,0.024582522,0.024873207,0.025486276,0.025223176},
{0.025552885,0.025190414,0.024963668,0.024877181,0.024946646,0.024779102,0.024552126,0.024895656,0.024853012,0.024882280,0.025289075,0.025358395,0.025438834,0.025205518,0.025041461,0.024867492,0.024751238,0.024692196,0.024583577,0.024775960,0.024770502,0.024894881,0.025509366,0.025689341},
{0.025756893,0.025458914,0.024844491,0.024777792,0.024570706,0.024358953,0.024589047,0.024901352,0.024918073,0.025042186,0.025175520,0.025203362,0.025348233,0.025333048,0.025100074,0.024869150,0.024762006,0.024474828,0.024336577,0.024567066,0.024669258,0.025089252,0.025105534,0.025785608},
{0.025567249,0.025231440,0.024973921,0.024879433,0.024709453,0.024605274,0.024814417,0.024789295,0.024907279,0.025155837,0.025306131,0.025381247,0.025205611,0.025300383,0.025033309,0.024939205,0.024739576,0.024655323,0.024524513,0.024677815,0.024598359,0.025155293,0.025301680,0.025474803},
{0.025334305,0.024992772,0.024985279,0.024656114,0.024546024,0.024667201,0.024718966,0.024571679,0.024727316,0.025139488,0.025190555,0.025127020,0.025221139,0.025121091,0.024972808,0.024929837,0.024745173,0.024824347,0.024658054,0.024560949,0.024791606,0.025066115,0.025345146,0.025621045},
{0.025580570,0.025396557,0.025001645,0.024802547,0.024672877,0.024920923,0.024410907,0.024797053,0.024828626,0.025272002,0.025085552,0.025280576,0.025383425,0.025276838,0.024946046,0.024979696,0.024668342,0.024574413,0.024503287,0.024649094,0.024868309,0.024978935,0.025057948,0.025462138},
{0.025448327,0.025522731,0.025078948,0.024613835,0.024811879,0.024622547,0.024682586,0.024630407,0.024927829,0.024963900,0.025236666,0.025165287,0.025375911,0.025035206,0.025012424,0.024874509,0.024876816,0.024520124,0.024673551,0.024545209,0.024681945,0.024973625,0.025254464,0.025421979},
{0.025525026,0.024974099,0.024957304,0.024696183,0.024779699,0.024381529,0.024638508,0.024921971,0.025174666,0.025134657,0.025207580,0.025363535,0.025229178,0.024962330,0.025093384,0.024877257,0.024813899,0.024671322,0.024738011,0.024495689,0.024803675,0.025040718,0.025074943,0.025166733},
{0.025386153,0.025275751,0.024964471,0.024685528,0.024524425,0.024473558,0.024543898,0.024896010,0.024867084,0.025014542,0.025345367,0.025299566,0.025444040,0.025136641,0.025042093,0.024783018,0.024751544,0.024552578,0.024439463,0.024663528,0.024726540,0.025229369,0.025152385,0.025382213},
{0.025478542,0.025236468,0.025072564,0.024854368,0.024730695,0.024660802,0.024621748,0.024886708,0.024827532,0.024977996,0.025283336,0.025210547,0.025283996,0.025258981,0.025002838,0.024803499,0.024839199,0.024576383,0.024558479,0.024570813,0.024763922,0.024987839,0.025369731,0.025113710},
{0.025512257,0.025260505,0.024960029,0.024697934,0.024613913,0.024602724,0.024788598,0.024668053,0.024988805,0.025072325,0.025326029,0.025338365,0.025210947,0.025299068,0.025105353,0.024835100,0.024716124,0.024794219,0.024655241,0.024746716,0.024659323,0.024748470,0.025234720,0.025315677},
{0.025576082,0.025358394,0.024717534,0.024807291,0.024291540,0.024517962,0.024725618,0.024791240,0.024959203,0.024925474,0.025197653,0.025604710,0.025273501,0.025052166,0.025150539,0.025026306,0.024682715,0.024746449,0.024535883,0.024674267,0.024661988,0.024885887,0.025303916,0.025307297}};
const double rochcor2015::mpavg[16][24]={{0.025608867,0.025351613,0.024942265,0.024717058,0.024626402,0.024670217,0.024581754,0.024682868,0.024866324,0.025245677,0.025441185,0.025437094,0.025425980,0.025250322,0.025188406,0.024863020,0.024716042,0.024764511,0.024656601,0.024706211,0.024901086,0.025013063,0.025339224,0.025619945},
{0.025825707,0.025282638,0.024963304,0.024791446,0.024571376,0.024653129,0.024740047,0.024814116,0.025032889,0.025088778,0.025141490,0.025312941,0.025476658,0.025271311,0.025155309,0.024979389,0.024879187,0.024847569,0.024638269,0.024904307,0.024776499,0.024981629,0.025175493,0.025601393},
{0.025720903,0.025315313,0.024844502,0.024735311,0.024606170,0.024789902,0.024686458,0.024914289,0.024778778,0.025169291,0.025220299,0.025408638,0.025392053,0.025329416,0.025293352,0.024951850,0.024722075,0.024560083,0.024883975,0.024705542,0.024767460,0.025185397,0.025152118,0.025438072},
{0.025312414,0.025321914,0.024928045,0.024750611,0.024576566,0.024602776,0.024606642,0.024711679,0.024751930,0.025121768,0.025265347,0.025476200,0.025429241,0.025304984,0.025109814,0.024962846,0.024841511,0.024819642,0.024694711,0.024727733,0.024672116,0.024990075,0.025084487,0.025490343},
{0.025530966,0.025208863,0.025037153,0.024895105,0.024717598,0.024364501,0.024569404,0.024580197,0.025153821,0.025121867,0.025350004,0.025355726,0.025261772,0.025251936,0.025111607,0.025016406,0.024777273,0.024771180,0.024749490,0.024561099,0.024732723,0.024912985,0.025462851,0.025375774},
{0.025443266,0.025417995,0.025082298,0.024720302,0.024412473,0.024540627,0.024542754,0.024812023,0.025075794,0.025155985,0.025285439,0.025380109,0.025456360,0.024992369,0.025036470,0.025106906,0.024771845,0.024575006,0.024623558,0.024489961,0.024772791,0.024908031,0.025566109,0.025656804},
{0.025433052,0.025304597,0.024989764,0.024762349,0.024662503,0.024624554,0.024720936,0.024621440,0.024796524,0.024917575,0.025206403,0.025271878,0.025315625,0.025329833,0.024876929,0.024957619,0.024763054,0.024673233,0.024752547,0.024723875,0.024649002,0.024995420,0.025568551,0.025508240},
{0.025809079,0.025153987,0.025196581,0.024714415,0.024630997,0.024609478,0.024523883,0.025042719,0.024992352,0.024865609,0.025172651,0.025448386,0.025478653,0.025064052,0.024977580,0.024893778,0.024838784,0.024931108,0.024622513,0.024788445,0.024871962,0.025122524,0.025392966,0.025589325},
{0.025615998,0.025461440,0.025008899,0.024876765,0.024661197,0.024835585,0.024681323,0.024816569,0.024904421,0.025196876,0.025253415,0.025311811,0.025268402,0.025092753,0.025086005,0.024886390,0.025043644,0.024687225,0.024712947,0.024697211,0.024674011,0.025076635,0.025144323,0.025701137},
{0.025582873,0.025157328,0.025133073,0.024693213,0.024465377,0.024772547,0.024675165,0.024752526,0.024866579,0.025097050,0.025324943,0.025363663,0.025386623,0.025233492,0.025065984,0.024908734,0.024760840,0.024830447,0.024810027,0.024708017,0.024858763,0.024703115,0.025170413,0.025753961},
{0.025652694,0.025520196,0.025233415,0.024798639,0.024683280,0.024619780,0.024852146,0.024865935,0.024742785,0.025049825,0.025229799,0.025431408,0.025359771,0.025234270,0.025081065,0.024949913,0.024717464,0.024584081,0.024606529,0.024634977,0.024828627,0.025020563,0.025135472,0.025900010},
{0.025522922,0.025247065,0.025109907,0.024855752,0.024762962,0.024591444,0.024686705,0.024769919,0.024990758,0.025088993,0.025087316,0.025443718,0.025464995,0.025254914,0.025264153,0.024921812,0.024852397,0.024820062,0.024784061,0.024720646,0.024745166,0.025079275,0.025244409,0.025290147},
{0.025897275,0.025332882,0.024915617,0.024863437,0.024451727,0.024526858,0.024766445,0.024787024,0.025024611,0.025060365,0.025395613,0.025285349,0.025306893,0.025116329,0.025088862,0.024872748,0.024786560,0.024665673,0.024664317,0.024713164,0.024778411,0.024985427,0.025032693,0.025362937},
{0.025503564,0.025377856,0.025129860,0.024602659,0.024866118,0.024587118,0.024458425,0.024934460,0.024777633,0.024896697,0.025280533,0.025264763,0.025291362,0.025136005,0.025056635,0.024963194,0.024770015,0.024669823,0.024540691,0.024388790,0.024735902,0.024876721,0.025481816,0.025697947},
{0.025543301,0.025297716,0.024950027,0.024781082,0.024772138,0.024729613,0.024662041,0.024821619,0.024840237,0.025148734,0.025215792,0.025462129,0.025426241,0.025188382,0.025372397,0.025049741,0.024760992,0.024639027,0.024549981,0.024665195,0.024750811,0.024821603,0.025446633,0.025586368},
{0.025699832,0.025139607,0.024988427,0.024634542,0.024641003,0.024633202,0.024787109,0.024878814,0.024941931,0.025032219,0.025316145,0.025363317,0.025445979,0.025254544,0.025280441,0.024944134,0.024879209,0.024798964,0.024644541,0.024651965,0.024705150,0.025106682,0.025584431,0.025523694}};
//==========================================================================================================================
const double rochcor2015::dcor_bfer[16][24]={{0.000147860,0.000139093,0.000101355,0.000092889,0.000100491,0.000095184,0.000092737,0.000090543,0.000088794,0.000086306,0.000087990,0.000086187,0.000086995,0.000087029,0.000086122,0.000088836,0.000092129,0.000093046,0.000094338,0.000099963,0.000093106,0.000102916,0.000138498,0.000151769},
{0.000148915,0.000140016,0.000100862,0.000093921,0.000098992,0.000096367,0.000092701,0.000090013,0.000087687,0.000087477,0.000089414,0.000086626,0.000087180,0.000087684,0.000086286,0.000088204,0.000090842,0.000091411,0.000096235,0.000099970,0.000094419,0.000099193,0.000141923,0.000145313},
{0.000147918,0.000141132,0.000100911,0.000095044,0.000099967,0.000096499,0.000093671,0.000092361,0.000090258,0.000087941,0.000088457,0.000087425,0.000087307,0.000088815,0.000087075,0.000090043,0.000091475,0.000093920,0.000095919,0.000099944,0.000093997,0.000100183,0.000138419,0.000148218},
{0.000146508,0.000138578,0.000102065,0.000095245,0.000100043,0.000095042,0.000094928,0.000091517,0.000088359,0.000087585,0.000089956,0.000089177,0.000087203,0.000089283,0.000087263,0.000088832,0.000093186,0.000094677,0.000095898,0.000099991,0.000095368,0.000101940,0.000137621,0.000145993},
{0.000148074,0.000139043,0.000100091,0.000094383,0.000100646,0.000096502,0.000095211,0.000091124,0.000089195,0.000085547,0.000090844,0.000088484,0.000087284,0.000089131,0.000087747,0.000089210,0.000092384,0.000093987,0.000094820,0.000101331,0.000095937,0.000102767,0.000142683,0.000147798},
{0.000148402,0.000139365,0.000099283,0.000093788,0.000099730,0.000096009,0.000091659,0.000089681,0.000088949,0.000085877,0.000087780,0.000087593,0.000086662,0.000087488,0.000086363,0.000086617,0.000089450,0.000093211,0.000096747,0.000099222,0.000095229,0.000100620,0.000141052,0.000144195},
{0.000148360,0.000141520,0.000101883,0.000094754,0.000099155,0.000095213,0.000090970,0.000090069,0.000088871,0.000086286,0.000088127,0.000087414,0.000086233,0.000087975,0.000085776,0.000088480,0.000090823,0.000093475,0.000093790,0.000099102,0.000093020,0.000100215,0.000137665,0.000147395},
{0.000147470,0.000143006,0.000102292,0.000095230,0.000099845,0.000095382,0.000092206,0.000090283,0.000087571,0.000085721,0.000088413,0.000086682,0.000088165,0.000086922,0.000087238,0.000089329,0.000090655,0.000093861,0.000095956,0.000098988,0.000095953,0.000102140,0.000140736,0.000147474},
{0.000146567,0.000137979,0.000101840,0.000094540,0.000100852,0.000096127,0.000092452,0.000089502,0.000088522,0.000086201,0.000086344,0.000087150,0.000087099,0.000087776,0.000086278,0.000087624,0.000090718,0.000092525,0.000094441,0.000099918,0.000094105,0.000100465,0.000140239,0.000147682},
{0.000150362,0.000140954,0.000101247,0.000095439,0.000099644,0.000095042,0.000092180,0.000089956,0.000088392,0.000085925,0.000088619,0.000087201,0.000086887,0.000087717,0.000086101,0.000088219,0.000089880,0.000093565,0.000095701,0.000100218,0.000095491,0.000102294,0.000140502,0.000148515},
{0.000147297,0.000140546,0.000101741,0.000095024,0.000100219,0.000095804,0.000092179,0.000092238,0.000087223,0.000085720,0.000101526,0.000088069,0.000086586,0.000088509,0.000087220,0.000087055,0.000091033,0.000095249,0.000094533,0.000099561,0.000093120,0.000102866,0.000140820,0.000149074},
{0.000147691,0.000138035,0.000102094,0.000094877,0.000099387,0.000093983,0.000091920,0.000092121,0.000090179,0.000084920,0.000090744,0.000085811,0.000086639,0.000101522,0.000085591,0.000088203,0.000091849,0.000093832,0.000096304,0.000100031,0.000094534,0.000102990,0.000139926,0.000146695},
{0.000147657,0.000143432,0.000101196,0.000092609,0.000099230,0.000095136,0.000092196,0.000092563,0.000086478,0.000087347,0.000088373,0.000087553,0.000087089,0.000103456,0.000087961,0.000087906,0.000091200,0.000092498,0.000096072,0.000100204,0.000095624,0.000100447,0.000139337,0.000151869},
{0.000147371,0.000139131,0.000100921,0.000092590,0.000100942,0.000094566,0.000093250,0.000088954,0.000087415,0.000086950,0.000086275,0.000086993,0.000086046,0.000087342,0.000086884,0.000087657,0.000090559,0.000094316,0.000094705,0.000099957,0.000094748,0.000101832,0.000137805,0.000147374},
{0.000148641,0.000138922,0.000102224,0.000094330,0.000101197,0.000096019,0.000092146,0.000091341,0.000087073,0.000086424,0.000087885,0.000085798,0.000086771,0.000086670,0.000086251,0.000086902,0.000090267,0.000092904,0.000095507,0.000098775,0.000093010,0.000102090,0.000141417,0.000148197},
{0.000148573,0.000136949,0.000102166,0.000093383,0.000100590,0.000094518,0.000093243,0.000091944,0.000088477,0.000085068,0.000089126,0.000085352,0.000087535,0.000086704,0.000085275,0.000087606,0.000093896,0.000093411,0.000095264,0.000099161,0.000094613,0.000102292,0.000139471,0.000146088}};
const double rochcor2015::dcor_maer[16][24]={{0.000147860,0.000139093,0.000101355,0.000092889,0.000100491,0.000095184,0.000092737,0.000090543,0.000088794,0.000086306,0.000087990,0.000086187,0.000086995,0.000087029,0.000086122,0.000088836,0.000092129,0.000093046,0.000094338,0.000099963,0.000093106,0.000102916,0.000138498,0.000151769},
{0.000148915,0.000140016,0.000100862,0.000093921,0.000098992,0.000096367,0.000092701,0.000090013,0.000087687,0.000087477,0.000089414,0.000086626,0.000087180,0.000087684,0.000086286,0.000088204,0.000090842,0.000091411,0.000096235,0.000099970,0.000094419,0.000099193,0.000141923,0.000145313},
{0.000147918,0.000141132,0.000100911,0.000095044,0.000099967,0.000096499,0.000093671,0.000092361,0.000090258,0.000087941,0.000088457,0.000087425,0.000087307,0.000088815,0.000087075,0.000090043,0.000091475,0.000093920,0.000095919,0.000099944,0.000093997,0.000100183,0.000138419,0.000148218},
{0.000146508,0.000138578,0.000102065,0.000095245,0.000100043,0.000095042,0.000094928,0.000091517,0.000088359,0.000087585,0.000089956,0.000089177,0.000087203,0.000089283,0.000087263,0.000088832,0.000093186,0.000094677,0.000095898,0.000099991,0.000095368,0.000101940,0.000137621,0.000145993},
{0.000148074,0.000139043,0.000100091,0.000094383,0.000100646,0.000096502,0.000095211,0.000091124,0.000089195,0.000085547,0.000090844,0.000088484,0.000087284,0.000089131,0.000087747,0.000089210,0.000092384,0.000093987,0.000094820,0.000101331,0.000095937,0.000102767,0.000142683,0.000147798},
{0.000148402,0.000139365,0.000099283,0.000093788,0.000099730,0.000096009,0.000091659,0.000089681,0.000088949,0.000085877,0.000087780,0.000087593,0.000086662,0.000087488,0.000086363,0.000086617,0.000089450,0.000093211,0.000096747,0.000099222,0.000095229,0.000100620,0.000141052,0.000144195},
{0.000148360,0.000141520,0.000101883,0.000094754,0.000099155,0.000095213,0.000090970,0.000090069,0.000088871,0.000086286,0.000088127,0.000087414,0.000086233,0.000087975,0.000085776,0.000088480,0.000090823,0.000093475,0.000093790,0.000099102,0.000093020,0.000100215,0.000137665,0.000147395},
{0.000147470,0.000143006,0.000102292,0.000095230,0.000099845,0.000095382,0.000092206,0.000090283,0.000087571,0.000085721,0.000088413,0.000086682,0.000088165,0.000086922,0.000087238,0.000089329,0.000090655,0.000093861,0.000095956,0.000098988,0.000095953,0.000102140,0.000140736,0.000147474},
{0.000146567,0.000137979,0.000101840,0.000094540,0.000100852,0.000096127,0.000092452,0.000089502,0.000088522,0.000086201,0.000086344,0.000087150,0.000087099,0.000087776,0.000086278,0.000087624,0.000090718,0.000092525,0.000094441,0.000099918,0.000094105,0.000100465,0.000140239,0.000147682},
{0.000150362,0.000140954,0.000101247,0.000095439,0.000099644,0.000095042,0.000092180,0.000089956,0.000088392,0.000085925,0.000088619,0.000087201,0.000086887,0.000087717,0.000086101,0.000088219,0.000089880,0.000093565,0.000095701,0.000100218,0.000095491,0.000102294,0.000140502,0.000148515},
{0.000147297,0.000140546,0.000101741,0.000095024,0.000100219,0.000095804,0.000092179,0.000092238,0.000087223,0.000085720,0.000101526,0.000088069,0.000086586,0.000088509,0.000087220,0.000087055,0.000091033,0.000095249,0.000094533,0.000099561,0.000093120,0.000102866,0.000140820,0.000149074},
{0.000147691,0.000138035,0.000102094,0.000094877,0.000099387,0.000093983,0.000091920,0.000092121,0.000090179,0.000084920,0.000090744,0.000085811,0.000086639,0.000101522,0.000085591,0.000088203,0.000091849,0.000093832,0.000096304,0.000100031,0.000094534,0.000102990,0.000139926,0.000146695},
{0.000147657,0.000143432,0.000101196,0.000092609,0.000099230,0.000095136,0.000092196,0.000092563,0.000086478,0.000087347,0.000088373,0.000087553,0.000087089,0.000103456,0.000087961,0.000087906,0.000091200,0.000092498,0.000096072,0.000100204,0.000095624,0.000100447,0.000139337,0.000151869},
{0.000147371,0.000139131,0.000100921,0.000092590,0.000100942,0.000094566,0.000093250,0.000088954,0.000087415,0.000086950,0.000086275,0.000086993,0.000086046,0.000087342,0.000086884,0.000087657,0.000090559,0.000094316,0.000094705,0.000099957,0.000094748,0.000101832,0.000137805,0.000147374},
{0.000148641,0.000138922,0.000102224,0.000094330,0.000101197,0.000096019,0.000092146,0.000091341,0.000087073,0.000086424,0.000087885,0.000085798,0.000086771,0.000086670,0.000086251,0.000086902,0.000090267,0.000092904,0.000095507,0.000098775,0.000093010,0.000102090,0.000141417,0.000148197},
{0.000148573,0.000136949,0.000102166,0.000093383,0.000100590,0.000094518,0.000093243,0.000091944,0.000088477,0.000085068,0.000089126,0.000085352,0.000087535,0.000086704,0.000085275,0.000087606,0.000093896,0.000093411,0.000095264,0.000099161,0.000094613,0.000102292,0.000139471,0.000146088}};
const double rochcor2015::mcor_bfer[16][24]={{0.000153799,0.000146820,0.000109741,0.000100244,0.000107992,0.000102603,0.000100258,0.000097394,0.000096834,0.000093462,0.000095446,0.000093516,0.000094517,0.000094268,0.000091723,0.000096905,0.000099757,0.000100158,0.000100787,0.000109090,0.000099830,0.000109948,0.000148370,0.000162075},
{0.000156551,0.000149739,0.000107519,0.000100089,0.000105585,0.000104493,0.000099148,0.000097036,0.000094966,0.000093912,0.000097699,0.000093163,0.000094009,0.000094442,0.000093082,0.000095504,0.000097361,0.000097758,0.000103433,0.000109180,0.000102980,0.000105880,0.000152208,0.000153096},
{0.000155444,0.000149781,0.000108029,0.000103935,0.000107239,0.000104177,0.000099962,0.000099622,0.000098430,0.000094410,0.000095240,0.000094716,0.000093640,0.000095221,0.000094070,0.000097947,0.000099183,0.000100328,0.000103256,0.000107434,0.000100971,0.000107886,0.000149954,0.000157457},
{0.000158875,0.000148648,0.000110309,0.000101972,0.000107887,0.000101251,0.000102383,0.000098838,0.000095050,0.000094835,0.000095793,0.000096056,0.000093560,0.000096575,0.000094030,0.000096404,0.000099605,0.000101967,0.000102531,0.000107156,0.000101503,0.000109246,0.000147031,0.000154592},
{0.000158583,0.000149926,0.000107991,0.000103099,0.000109156,0.000104468,0.000103271,0.000098308,0.000096128,0.000091791,0.000097922,0.000094668,0.000092873,0.000096114,0.000094780,0.000096460,0.000099945,0.000101479,0.000102770,0.000108291,0.000104406,0.000108437,0.000153413,0.000156679},
{0.000155578,0.000151317,0.000106362,0.000101022,0.000107377,0.000104490,0.000097763,0.000095561,0.000095762,0.000092621,0.000094380,0.000094394,0.000093857,0.000093964,0.000093208,0.000092657,0.000095459,0.000100956,0.000105202,0.000106989,0.000103533,0.000108615,0.000151626,0.000151867},
{0.000159314,0.000151244,0.000109313,0.000102912,0.000108215,0.000102406,0.000097720,0.000097426,0.000095468,0.000093478,0.000093719,0.000094167,0.000092987,0.000095961,0.000092449,0.000095745,0.000098740,0.000101372,0.000100689,0.000106425,0.000099870,0.000108024,0.000145468,0.000155792},
{0.000155184,0.000154234,0.000109838,0.000101113,0.000108510,0.000103578,0.000098446,0.000097055,0.000093661,0.000092339,0.000095072,0.000093069,0.000094631,0.000093357,0.000095247,0.000097436,0.000096875,0.000100920,0.000103051,0.000105960,0.000103954,0.000110740,0.000151999,0.000154086},
{0.000155421,0.000145074,0.000109387,0.000101539,0.000108715,0.000104146,0.000099325,0.000096423,0.000096488,0.000093726,0.000092742,0.000093535,0.000094456,0.000094205,0.000093268,0.000094900,0.000098030,0.000099298,0.000102001,0.000107328,0.000100757,0.000106968,0.000150812,0.000156150},
{0.000159887,0.000151261,0.000108666,0.000103602,0.000107751,0.000102926,0.000100111,0.000096993,0.000096316,0.000092537,0.000094928,0.000095404,0.000093742,0.000093562,0.000093171,0.000095802,0.000096726,0.000100608,0.000104118,0.000107889,0.000103650,0.000109045,0.000150479,0.000160384},
{0.000157978,0.000150027,0.000110050,0.000102786,0.000107672,0.000103698,0.000098924,0.000098601,0.000094163,0.000091089,0.000107446,0.000094995,0.000093084,0.000095753,0.000093269,0.000094591,0.000098387,0.000103297,0.000101360,0.000106722,0.000099609,0.000111636,0.000149821,0.000159339},
{0.000158424,0.000147721,0.000111191,0.000102855,0.000107972,0.000101502,0.000098851,0.000098625,0.000097872,0.000091519,0.000097699,0.000091978,0.000092664,0.000108601,0.000091758,0.000095071,0.000099348,0.000101461,0.000103226,0.000107595,0.000102221,0.000111072,0.000149456,0.000155915},
{0.000156813,0.000152761,0.000108502,0.000099328,0.000108030,0.000102399,0.000098243,0.000100047,0.000092256,0.000094064,0.000094546,0.000094217,0.000093619,0.000107308,0.000093778,0.000093667,0.000097168,0.000098645,0.000104445,0.000108646,0.000102952,0.000107921,0.000150806,0.000161146},
{0.000156882,0.000148779,0.000109251,0.000100080,0.000110103,0.000100933,0.000101115,0.000095488,0.000093794,0.000094113,0.000092406,0.000094032,0.000092892,0.000093698,0.000093806,0.000094344,0.000096569,0.000102337,0.000102536,0.000108821,0.000103608,0.000109913,0.000147428,0.000158696},
{0.000161320,0.000150058,0.000109755,0.000102012,0.000110010,0.000103574,0.000099549,0.000098918,0.000092812,0.000092366,0.000094831,0.000091705,0.000093508,0.000094253,0.000093344,0.000093619,0.000097180,0.000101019,0.000102639,0.000106527,0.000099955,0.000109927,0.000152880,0.000160034},
{0.000158635,0.000144856,0.000109462,0.000098514,0.000108557,0.000101171,0.000100726,0.000099101,0.000095497,0.000092637,0.000096902,0.000091995,0.000094462,0.000093127,0.000091829,0.000094248,0.000097815,0.000099929,0.000103682,0.000107183,0.000102619,0.000109493,0.000150152,0.000155675}};
const double rochcor2015::mcor_maer[16][24]={{0.000153799,0.000146820,0.000109741,0.000100244,0.000107992,0.000102603,0.000100258,0.000097394,0.000096834,0.000093462,0.000095446,0.000093516,0.000094517,0.000094268,0.000091723,0.000096905,0.000099757,0.000100158,0.000100787,0.000109090,0.000099830,0.000109948,0.000148370,0.000162075},
{0.000156551,0.000149739,0.000107519,0.000100089,0.000105585,0.000104493,0.000099148,0.000097036,0.000094966,0.000093912,0.000097699,0.000093163,0.000094009,0.000094442,0.000093082,0.000095504,0.000097361,0.000097758,0.000103433,0.000109180,0.000102980,0.000105880,0.000152208,0.000153096},
{0.000155444,0.000149781,0.000108029,0.000103935,0.000107239,0.000104177,0.000099962,0.000099622,0.000098430,0.000094410,0.000095240,0.000094716,0.000093640,0.000095221,0.000094070,0.000097947,0.000099183,0.000100328,0.000103256,0.000107434,0.000100971,0.000107886,0.000149954,0.000157457},
{0.000158875,0.000148648,0.000110309,0.000101972,0.000107887,0.000101251,0.000102383,0.000098838,0.000095050,0.000094835,0.000095793,0.000096056,0.000093560,0.000096575,0.000094030,0.000096404,0.000099605,0.000101967,0.000102531,0.000107156,0.000101503,0.000109246,0.000147031,0.000154592},
{0.000158583,0.000149926,0.000107991,0.000103099,0.000109156,0.000104468,0.000103271,0.000098308,0.000096128,0.000091791,0.000097922,0.000094668,0.000092873,0.000096114,0.000094780,0.000096460,0.000099945,0.000101479,0.000102770,0.000108291,0.000104406,0.000108437,0.000153413,0.000156679},
{0.000155578,0.000151317,0.000106362,0.000101022,0.000107377,0.000104490,0.000097763,0.000095561,0.000095762,0.000092621,0.000094380,0.000094394,0.000093857,0.000093964,0.000093208,0.000092657,0.000095459,0.000100956,0.000105202,0.000106989,0.000103533,0.000108615,0.000151626,0.000151867},
{0.000159314,0.000151244,0.000109313,0.000102912,0.000108215,0.000102406,0.000097720,0.000097426,0.000095468,0.000093478,0.000093719,0.000094167,0.000092987,0.000095961,0.000092449,0.000095745,0.000098740,0.000101372,0.000100689,0.000106425,0.000099870,0.000108024,0.000145468,0.000155792},
{0.000155184,0.000154234,0.000109838,0.000101113,0.000108510,0.000103578,0.000098446,0.000097055,0.000093661,0.000092339,0.000095072,0.000093069,0.000094631,0.000093357,0.000095247,0.000097436,0.000096875,0.000100920,0.000103051,0.000105960,0.000103954,0.000110740,0.000151999,0.000154086},
{0.000155421,0.000145074,0.000109387,0.000101539,0.000108715,0.000104146,0.000099325,0.000096423,0.000096488,0.000093726,0.000092742,0.000093535,0.000094456,0.000094205,0.000093268,0.000094900,0.000098030,0.000099298,0.000102001,0.000107328,0.000100757,0.000106968,0.000150812,0.000156150},
{0.000159887,0.000151261,0.000108666,0.000103602,0.000107751,0.000102926,0.000100111,0.000096993,0.000096316,0.000092537,0.000094928,0.000095404,0.000093742,0.000093562,0.000093171,0.000095802,0.000096726,0.000100608,0.000104118,0.000107889,0.000103650,0.000109045,0.000150479,0.000160384},
{0.000157978,0.000150027,0.000110050,0.000102786,0.000107672,0.000103698,0.000098924,0.000098601,0.000094163,0.000091089,0.000107446,0.000094995,0.000093084,0.000095753,0.000093269,0.000094591,0.000098387,0.000103297,0.000101360,0.000106722,0.000099609,0.000111636,0.000149821,0.000159339},
{0.000158424,0.000147721,0.000111191,0.000102855,0.000107972,0.000101502,0.000098851,0.000098625,0.000097872,0.000091519,0.000097699,0.000091978,0.000092664,0.000108601,0.000091758,0.000095071,0.000099348,0.000101461,0.000103226,0.000107595,0.000102221,0.000111072,0.000149456,0.000155915},
{0.000156813,0.000152761,0.000108502,0.000099328,0.000108030,0.000102399,0.000098243,0.000100047,0.000092256,0.000094064,0.000094546,0.000094217,0.000093619,0.000107308,0.000093778,0.000093667,0.000097168,0.000098645,0.000104445,0.000108646,0.000102952,0.000107921,0.000150806,0.000161146},
{0.000156882,0.000148779,0.000109251,0.000100080,0.000110103,0.000100933,0.000101115,0.000095488,0.000093794,0.000094113,0.000092406,0.000094032,0.000092892,0.000093698,0.000093806,0.000094344,0.000096569,0.000102337,0.000102536,0.000108821,0.000103608,0.000109913,0.000147428,0.000158696},
{0.000161320,0.000150058,0.000109755,0.000102012,0.000110010,0.000103574,0.000099549,0.000098918,0.000092812,0.000092366,0.000094831,0.000091705,0.000093508,0.000094253,0.000093344,0.000093619,0.000097180,0.000101019,0.000102639,0.000106527,0.000099955,0.000109927,0.000152880,0.000160034},
{0.000158635,0.000144856,0.000109462,0.000098514,0.000108557,0.000101171,0.000100726,0.000099101,0.000095497,0.000092637,0.000096902,0.000091995,0.000094462,0.000093127,0.000091829,0.000094248,0.000097815,0.000099929,0.000103682,0.000107183,0.000102619,0.000109493,0.000150152,0.000155675}};

//==========================================================================================================================

const double rochcor2015::dd[12]={0.0135375,0.0129037,0.00458473,0.0294874,0.0261289,0.0234373,0.0362774,0.02023,0.0172767,0.0558127,0.0741892,0.135656};
const double rochcor2015::md[12]={0.00501882,0.000352594,-0.00308157,0.00998455,-0.00484126,-0.00594442,0.0168821,-0.00368368,0.0167904,0.0444465,0.0411393,0.033297};

const double rochcor2015::dscl[24]={0.999068,0.999734,0.999629,0.999913,0.999614,0.999937,1.00022,1.00024,
				    1.00014,0.999862,1.00063,1.00025,1.00065,0.999977,1.00037,1.00022,1.00025,
				    1.00014,0.99978,0.999479,0.999675,0.999222,0.999796,0.999117}
;
const double rochcor2015::mscl[24]={0.998936,0.999539,0.999569,0.999981,0.999746,1.00003,1.00003,1.00005,
				    1.00036,1.00006,1.00015,1.00021,1.0002,0.999966,1.00025,1.00012,0.999907,
				    1.00008,0.999743,0.999687,0.999932,1.00002,1.00005,0.999848};

muresolution muresol1;

//===============================================================================================

rochcor2015::~rochcor2015(){
}

rochcor2015::rochcor2015(){
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2015::rochcor2015(int seed){
  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2015::momcor_mc( TLorentzVector& mu, float charge, int ntrk, float& qter){
  
  //sysdev == num : deviation = num
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root

  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    double Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    //for the momentum tuning - eta,phi,Q correction
    mupt *= cor;
    
    double gscl = (genm_smr/mrecm)*mgscl_iter;
    double gscler = mgscl_stat;    
    double tune = muresol1.kSmear(mupt,mueta,ntrk,muresolution::Extra);
    //double tune = 1.0;

    mupt *= (gscl + gscler_mc_dev*gscler)*(tune*mscl[mu_etabin]);    

    //dE/dx correction for low pt is not available in rereco version yet
    //double pt_tune = (mupt-md[mu_aetabin])*45.0/(45.0-md[mu_aetabin]);
    //mupt = pt_tune;

    double momscl = mupt_bfcor/mupt;
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
}


void rochcor2015::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root
  
  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);

  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    double Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    mupt *= cor;  
    
    //after Z pt correction
    double gscl = (genm_smr/drecm)*dgscl_iter;
    double gscler = dgscl_stat;

    mupt *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    
    //dE/dx correction for low pt is not available in rereco version yet
    //double pt_tune = (mupt-dd[mu_aetabin])*45.0/(45.0-dd[mu_aetabin]);
    //mupt = pt_tune; 

    double momscl = mupt_bfcor/mupt;
    qter *= momscl;
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
  
}

Int_t rochcor2015::phibin(double phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2015::etabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}



Int_t rochcor2015::aetabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<12; i++){
    if(anetabin[i] <= fabs(eta) && anetabin[i+1] > fabs(eta)){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

